<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis School - EduTrack Pro</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: '#4F46E5', secondary: '#10B981', surface: '#FFFFFF' },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F3F4F6; }
        .animate-fade-in { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-presets="react,typescript">
        const { useState, useEffect } = React;
        // L·∫•y c√°c icon t·ª´ th∆∞ vi·ªán Lucide
        const { LayoutDashboard, Users, MessageSquare, Download, FileSpreadsheet, FileText, Settings, X, Camera, MessageCircle, Send, Flame } = lucide;

        // --- 2. GI·∫¢ L·∫¨P D·ªÆ LI·ªÜU & COMPONENT CON (V√¨ thi·∫øu file g·ªëc) ---
        
        // D·ªØ li·ªáu m·∫´u
        const MOCK_CLASSES = [
            { id: 'c1', name: '6B1', grade: 6, room: 'P201', studentCount: 32 },
            { id: 'c2', name: '8A2', grade: 8, room: 'P305', studentCount: 28 }
        ];
        
        const MOCK_STUDENTS = [
            { id: 's1', name: 'Nguy·ªÖn VƒÉn An', classId: 'c1', grades: [{score: 8, coefficient: 1}, {score: 9, coefficient: 2}] },
            { id: 's2', name: 'Tr·∫ßn Th·ªã B√≠ch', classId: 'c1', grades: [{score: 7, coefficient: 1}, {score: 7.5, coefficient: 2}] },
            { id: 's3', name: 'L√™ Ho√†ng Nam', classId: 'c2', grades: [{score: 9.5, coefficient: 1}, {score: 9, coefficient: 2}] }
        ];
        
        const MOCK_TEMPLATES = [
            { id: 't1', title: 'H·ªçc t·∫≠p t·ªët', content: 'Con h·ªçc t·∫≠p r·∫•t chƒÉm ch·ªâ, ti·∫øp thu b√†i nhanh.' },
            { id: 't2', title: 'C·∫ßn c·ªë g·∫Øng', content: 'Con c·∫ßn t·∫≠p trung h∆°n trong gi·ªù h·ªçc.' }
        ];

        // Component Gi·∫£ l·∫≠p (Placeholder) cho c√°c Tab con
        const OverviewTab = ({ students, classes }) => (
            <div className="bg-white p-6 rounded-xl shadow-sm">
                <h2 className="text-xl font-bold mb-4 text-indigo-600">üìä T·ªïng quan (Demo)</h2>
                <div className="grid grid-cols-3 gap-4">
                    <div className="p-4 bg-blue-50 rounded-lg">
                        <p className="text-sm text-gray-500">T·ªïng h·ªçc sinh</p>
                        <p className="text-2xl font-bold">{students.length}</p>
                    </div>
                    <div className="p-4 bg-green-50 rounded-lg">
                        <p className="text-sm text-gray-500">T·ªïng l·ªõp ch·ªß nhi·ªám</p>
                        <p className="text-2xl font-bold">{classes.length}</p>
                    </div>
                </div>
                <p className="mt-4 text-gray-500 text-sm italic">*ƒê√¢y l√† giao di·ªán gi·∫£ l·∫≠p v√¨ thi·∫øu file OverviewTab.tsx</p>
            </div>
        );

        const ClassTab = ({ classes, students, onUpdateStudent }) => (
            <div className="bg-white p-6 rounded-xl shadow-sm">
                <h2 className="text-xl font-bold mb-4 text-green-600">üë• Danh s√°ch L·ªõp (Demo)</h2>
                <ul className="space-y-2">
                    {classes.map(c => (
                        <li key={c.id} className="p-3 border rounded-lg flex justify-between">
                            <span>L·ªõp <b>{c.name}</b></span>
                            <span className="bg-gray-100 px-2 rounded">{c.studentCount} HS</span>
                        </li>
                    ))}
                </ul>
                <div className="mt-6">
                    <h3 className="font-bold mb-2">Danh s√°ch h·ªçc sinh m·∫´u:</h3>
                    {students.map(s => (
                        <div key={s.id} className="p-2 border-b text-sm flex justify-between">
                            <span>{s.name}</span>
                            <span>{s.grades.length > 0 ? "ƒê√£ c√≥ ƒëi·ªÉm" : "Ch∆∞a c√≥ ƒëi·ªÉm"}</span>
                        </div>
                    ))}
                </div>
                <p className="mt-4 text-gray-500 text-sm italic">*ƒê√¢y l√† giao di·ªán gi·∫£ l·∫≠p v√¨ thi·∫øu file ClassTab.tsx</p>
            </div>
        );

        const CommentsTab = () => (
             <div className="bg-white p-6 rounded-xl shadow-sm">
                <h2 className="text-xl font-bold mb-4 text-orange-600">ü§ñ Tr·ª£ l√Ω AI (Demo)</h2>
                <p>T√≠nh nƒÉng t·∫°o nh·∫≠n x√©t t·ª± ƒë·ªông b·∫±ng AI s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y.</p>
            </div>
        );

        // Mock Services
        const exportToCSV = (data, name) => alert(`ƒê√£ xu·∫•t file Excel: ${name}.csv (Gi·∫£ l·∫≠p)`);
        const generateClassReportPDF = (title) => alert(`ƒê√£ t·∫°o PDF b√°o c√°o: ${title} (Gi·∫£ l·∫≠p)`);

        // --- 3. MAIN APP (CODE C·ª¶A TH·∫¶Y TH√ÅI) ---
        // (T√¥i ƒë√£ ch·ªânh s·ª≠a nh·∫π ph·∫ßn import ƒë·ªÉ ch·∫°y ƒë∆∞·ª£c tr√™n browser)

        function App() {
            const [activeTab, setActiveTab] = useState('overview');
            const [semester, setSemester] = useState('HK1');
            
            // Navigation State
            const [targetStudentId, setTargetStudentId] = useState(null);

            // Teacher Info State
            const [teacherName, setTeacherName] = useState('Nguy·ªÖn VƒÉn Th√°i');
            const [teacherAvatar, setTeacherAvatar] = useState('https://picsum.photos/200');
            const [isEditingTeacher, setIsEditingTeacher] = useState(false);
            const [isFeedbackOpen, setIsFeedbackOpen] = useState(false);
            const [feedbackText, setFeedbackText] = useState('');
            
            // Gamification State
            const [streak, setStreak] = useState(0);

            // Global State
            const [classes, setClasses] = useState(MOCK_CLASSES);
            const [students, setStudents] = useState(MOCK_STUDENTS);
            const [templates, setTemplates] = useState(MOCK_TEMPLATES);

            // Initialize Streak Logic
            useEffect(() => {
                const checkStreak = () => {
                    // Logic streak gi·∫£n l∆∞·ª£c ƒë·ªÉ demo
                    setStreak(5); 
                };
                checkStreak();
            }, []);

            // Handler to jump to a student from Overview
            const handleSuggestionClick = (studentId) => {
                setTargetStudentId(studentId);
                setActiveTab('classes');
            };

            // --- Student Actions (Simplified) ---
            const updateStudent = (updatedStudent) => {
                setStudents(prev => prev.map(s => s.id === updatedStudent.id ? updatedStudent : s));
            };
            const addStudent = (newStudent) => setStudents(prev => [...prev, newStudent]);
            const addStudents = (newStudents) => setStudents(prev => [...prev, ...newStudents]);
            const deleteStudent = (studentId) => {
                if (window.confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a h·ªçc sinh n√†y?')) {
                    setStudents(prev => prev.filter(s => s.id !== studentId));
                }
            };

            // --- Class Actions ---
            const addClass = (newClass) => setClasses(prev => [...prev, newClass]);
            const updateClass = (updatedClass) => setClasses(prev => prev.map(c => c.id === updatedClass.id ? updatedClass : c));
            const deleteClass = (classId) => {
                if (window.confirm('B·∫°n c√≥ mu·ªën x√≥a l·ªõp n√†y kh√¥ng?')) {
                    setClasses(prev => prev.filter(c => c.id !== classId));
                }
            };

            const handleExportAll = (type) => {
                if (type === 'excel') {
                    const data = students.map(s => ({
                        ID: s.id, Name: s.name, ClassID: s.classId
                    }));
                    exportToCSV(data, 'School_Report');
                } else {
                    generateClassReportPDF("TOAN TRUONG", students, semester);
                }
            };

            const submitFeedback = () => {
                if(!feedbackText.trim()) return;
                alert("C·∫£m ∆°n th·∫ßy/c√¥ ƒë√£ ƒë√≥ng g√≥p √Ω ki·∫øn!");
                setFeedbackText('');
                setIsFeedbackOpen(false);
            }

            // Edit form state
            const [tempName, setTempName] = useState(teacherName);
            const [tempAvatar, setTempAvatar] = useState(teacherAvatar);

            const saveTeacherInfo = () => {
                setTeacherName(tempName);
                setTeacherAvatar(tempAvatar);
                setIsEditingTeacher(false);
            }

            // GIAO DI·ªÜN CH√çNH
            return (
                <div className="min-h-screen bg-gray-50 font-sans text-gray-800 flex flex-col md:flex-row">
                {/* Sidebar Navigation */}
                <aside className="w-full md:w-64 bg-white border-r border-gray-200 flex flex-col md:fixed h-auto md:h-full z-10 transition-all duration-300">
                    <div className="h-20 flex items-center justify-center md:justify-start md:px-6 border-b border-gray-100">
                    <div className="flex items-center gap-2">
                         <div className="w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center text-white font-bold">G</div>
                         <span className="font-bold text-lg text-green-700 tracking-tight">Genesis School</span>
                    </div>
                    </div>

                    <nav className="flex-1 py-4 md:py-6 space-y-2 px-2 md:px-4 flex md:flex-col justify-around md:justify-start">
                    <button onClick={() => setActiveTab('overview')} className={`w-full flex items-center justify-center md:justify-start p-3 rounded-xl transition-all duration-200 ${activeTab === 'overview' ? 'bg-green-50 text-green-700 shadow-sm font-semibold' : 'text-gray-500 hover:bg-gray-100'}`}>
                        <LayoutDashboard size={22} />
                        <span className="hidden md:block ml-3">T·ªïng quan</span>
                    </button>

                    <button onClick={() => setActiveTab('classes')} className={`w-full flex items-center justify-center md:justify-start p-3 rounded-xl transition-all duration-200 ${activeTab === 'classes' ? 'bg-green-50 text-green-700 shadow-sm font-semibold' : 'text-gray-500 hover:bg-gray-100'}`}>
                        <Users size={22} />
                        <span className="hidden md:block ml-3">L·ªõp h·ªçc</span>
                    </button>

                    <button onClick={() => setActiveTab('comments')} className={`w-full flex items-center justify-center md:justify-start p-3 rounded-xl transition-all duration-200 ${activeTab === 'comments' ? 'bg-green-50 text-green-700 shadow-sm font-semibold' : 'text-gray-500 hover:bg-gray-100'}`}>
                        <MessageSquare size={22} />
                        <span className="hidden md:block ml-3">Nh·∫≠n x√©t & AI</span>
                    </button>
                    </nav>
                </aside>

                {/* Main Content Area */}
                <main className="flex-1 md:ml-64 p-4 md:p-8 overflow-y-auto min-h-screen relative">
                    <header className="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div>
                            <h1 className="text-2xl font-bold text-gray-900">
                                {activeTab === 'overview' && 'T·ªïng quan l·ªõp h·ªçc'}
                                {activeTab === 'classes' && 'Qu·∫£n l√Ω H·ªçc sinh'}
                                {activeTab === 'comments' && 'Th∆∞ vi·ªán & Tr·ª£ l√Ω AI'}
                            </h1>
                            <p className="text-sm text-gray-500 mt-1">H·ªá th·ªëng qu·∫£n l√Ω gi√°o d·ª•c Genesis School</p>
                        </div>
                        
                        <div className="flex items-center gap-3 bg-white p-2 rounded-xl shadow-sm border border-gray-200">
                            {/* Streak */}
                            <div className="hidden sm:flex items-center gap-1 px-3 py-1 bg-orange-50 text-orange-600 rounded-lg border border-orange-100">
                                <Flame size={18} className="fill-orange-500 animate-pulse" />
                                <span className="font-bold text-sm">{streak} ng√†y</span>
                            </div>

                            <div className="flex flex-col px-2 border-l border-gray-100 pl-4">
                                <span className="text-[10px] text-gray-400 font-bold uppercase">H·ªçc k√¨</span>
                                <select value={semester} onChange={(e) => setSemester(e.target.value)} className="text-sm font-bold text-green-700 bg-transparent outline-none border-none p-0">
                                    <option value="HK1">H·ªçc k√¨ I</option>
                                    <option value="HK2">H·ªçc k√¨ II</option>
                                </select>
                            </div>

                            <div className="flex items-center space-x-2 pr-2 cursor-pointer hover:bg-gray-50 rounded-lg p-1" onClick={() => { setTempName(teacherName); setTempAvatar(teacherAvatar); setIsEditingTeacher(true); }}>
                                <div className="text-right hidden sm:block">
                                    <p className="text-xs font-semibold text-gray-700">{teacherName}</p>
                                    <p className="text-[10px] text-gray-400">Gi√°o vi√™n CN</p>
                                </div>
                                <img src={teacherAvatar} alt="Profile" className="w-9 h-9 rounded-full border-2 border-green-100 object-cover" />
                            </div>
                        </div>
                    </header>

                    <div className="relative z-10">
                        {activeTab === 'overview' && <OverviewTab students={students} classes={classes} semester={semester} />}
                        {activeTab === 'classes' && <ClassTab classes={classes} students={students} onUpdateStudent={updateStudent} />}
                        {activeTab === 'comments' && <CommentsTab />}
                    </div>

                    {/* Edit Teacher Modal */}
                    {isEditingTeacher && (
                        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in">
                            <div className="bg-white rounded-xl shadow-2xl p-6 w-96 relative">
                                <button onClick={() => setIsEditingTeacher(false)} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><X size={20} /></button>
                                <h3 className="text-lg font-bold text-gray-800 mb-4">Th√¥ng tin Gi√°o vi√™n</h3>
                                <div className="flex flex-col items-center mb-4">
                                    <img src={tempAvatar} className="w-20 h-20 rounded-full border-4 border-gray-100 mb-2" />
                                    <input type="text" placeholder="URL ·∫¢nh" value={tempAvatar} onChange={(e) => setTempAvatar(e.target.value)} className="text-xs border-b w-full p-1 text-center" />
                                </div>
                                <div className="mb-4">
                                    <label className="text-xs font-bold text-gray-500 uppercase">T√™n hi·ªÉn th·ªã</label>
                                    <input type="text" value={tempName} onChange={(e) => setTempName(e.target.value)} className="w-full mt-1 p-2 border border-gray-300 rounded-lg text-sm" />
                                </div>
                                <button onClick={saveTeacherInfo} className="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 rounded-lg">L∆∞u thay ƒë·ªïi</button>
                            </div>
                        </div>
                    )}
                </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
